<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.0">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="TributeDAO Framework Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="TributeDAO Framework Blog Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="TributeDAO Framework" href="/opensearch.xml"><title data-react-helmet="true">ERC1271 Signatures | TributeDAO Framework</title><meta data-react-helmet="true" property="og:url" content="https://tributedao.com/docs/contracts/extensions/erc1271-extension"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="ERC1271 Signatures | TributeDAO Framework"><meta data-react-helmet="true" name="description" content="Extension description and scope"><meta data-react-helmet="true" property="og:description" content="Extension description and scope"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://tributedao.com/docs/contracts/extensions/erc1271-extension"><link data-react-helmet="true" rel="alternate" href="https://tributedao.com/docs/contracts/extensions/erc1271-extension" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://tributedao.com/docs/contracts/extensions/erc1271-extension" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://JM91LTL6DB-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.eed37a75.css">
<link rel="preload" href="/assets/js/runtime~main.dff14f16.js" as="script">
<link rel="preload" href="/assets/js/main.bf7fe461.js" as="script">
</head>
<body>
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="TributeDAO Framework Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo.svg" alt="TributeDAO Framework Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">TRIBUTE</strong></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/intro/overview-and-benefits">Get Started</a><a class="navbar__item navbar__link" href="/docs/intro/design/core/introduction">Core</a><a class="navbar__item navbar__link" href="/docs/intro/design/extensions/introduction">Extensions</a><a class="navbar__item navbar__link" href="/docs/intro/design/adapters/introduction">Adapters</a><a class="navbar__item navbar__link navbar__link--active" href="/docs/thanks">Thank You</a><a href="https://github.com/search?q=org%3Aopenlawteam+tribute-ui+OR+tribute-contracts+in%3Aname&amp;type=repositories" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="TributeDAO Framework Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo.svg" alt="TributeDAO Framework Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">TRIBUTE</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/intro/overview-and-benefits">Get Started</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/intro/design/core/introduction">Core</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/intro/design/extensions/introduction">Extensions</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/intro/design/adapters/introduction">Adapters</a></li><li class="menu__list-item"><a class="menu__link navbar__link--active" href="/docs/thanks">Thank You</a></li><li class="menu__list-item"><a href="https://github.com/search?q=org%3Aopenlawteam+tribute-ui+OR+tribute-contracts+in%3Aname&amp;type=repositories" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><main class="docMainContainer_3ufF docMainContainerEnhanced_3NYZ"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><header><h1 class="docTitle_3a4h">ERC1271 Signatures</h1></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="extension-description-and-scope"></a>Extension description and scope<a class="hash-link" href="#extension-description-and-scope" title="Direct link to heading">#</a></h2><p>The ERC1271 extension allows DAOs to collectively sign messages and typed data through signatures. ERC1271 is a contract signature standard that enables smart contract wallets to behave like EOAs (externally owned accounts). Signatures are critical when interacting with various types of decentralized applications. Developers use signatures for authentication, meta-transactions, order books, and anything that requires delegated permission or proof of ownership of an address. ERC1271 has widespread adoption and is used in applications like Argent and Snapshot.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="extension-workflow"></a>Extension workflow<a class="hash-link" href="#extension-workflow" title="Direct link to heading">#</a></h2><p>In order to register a signature with the DAO, a member must submit a proposal in which they specify the signature message digest, the signature, and the magic value to return on success.</p><p>The message digest must be the hash of the message to sign. This can be a simple message hash, a personal signature (message with special prefix), or a typed data signature (message created using structured data).</p><p>The proposal enters the voting process.</p><p>If the vote passes, the extension returns the magic value when queried via the ERC1271 interface.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="extension-state"></a>Extension state<a class="hash-link" href="#extension-state" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="daoregistry-public-dao"></a>DaoRegistry public dao;<a class="hash-link" href="#daoregistry-public-dao" title="Direct link to heading">#</a></h3><p>The DAO address that this extension belongs to</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="bool-public-initialized--false"></a>bool public initialized = false;<a class="hash-link" href="#bool-public-initialized--false" title="Direct link to heading">#</a></h3><p>Internally tracks deployment under ERC-1167 proxy pattern</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="daosignature-struct"></a>DAOSignature struct<a class="hash-link" href="#daosignature-struct" title="Direct link to heading">#</a></h3><ul><li><code>signatureProposals</code>: all signature proposals handled by each DAO.</li><li><code>SignatureDetails</code>:<ul><li><code>signature</code>: the signature associated with this proposal. May be used to encode other attributes for efficiency, since it is not a real signature and would just be wasted storage space</li><li><code>msgHash</code>: the digest of the data to sign</li><li><code>magicValue</code>: the value to return if a signature proposal has passed</li></ul></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="dependencies-and-interactions-internal--external"></a>Dependencies and interactions (internal / external)<a class="hash-link" href="#dependencies-and-interactions-internal--external" title="Direct link to heading">#</a></h2><ul><li><p>Voting</p><ul><li>starts new voting for the signature proposal.</li><li>checks the voting results.</li></ul></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="functions-description-and-assumptions--checks"></a>Functions description and assumptions / checks<a class="hash-link" href="#functions-description-and-assumptions--checks" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="function-initialize"></a>function initialize<a class="hash-link" href="#function-initialize" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly solidity"><div tabindex="0" class="prism-code language-solidity codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">/**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  * @notice Initializes the extension with the DAO that it belongs to,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  * and checks if the parameters were set.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  * @param _dao The address of the DAO that owns the extension.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  * @param creator The owner of the DAO and Extension that is also a member of the DAO.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">function initialize(DaoRegistry _dao, address creator) external override</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="function-sign"></a>function sign<a class="hash-link" href="#function-sign" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly solidity"><div tabindex="0" class="prism-code language-solidity codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     * @notice Registers a valid signature in the extension</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     * @dev Only DAOs with this extension registered can call this function</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     * @param signatureHash The hash of the signature</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     * @param permissionHash The digest of the data to be signed</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     * @param magicValue The value to be returned by the ERC1271 interface upon success</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function sign(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        bytes32 permissionHash,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        bytes32 signatureHash,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        bytes4 magicValue</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ) internal virtual hasExtensionAccess(AclFlag.SIGN)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="function-isvalidsignature"></a>function isValidSignature<a class="hash-link" href="#function-isvalidsignature" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly solidity"><div tabindex="0" class="prism-code language-solidity codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function isValidSignature(bytes32 permissionHash, bytes memory signature)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        public</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        view</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        override</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        returns (bytes4)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="events"></a>Events<a class="hash-link" href="#events" title="Direct link to heading">#</a></h2><p>List all the events that are emitted by the function in this Extension implementation.</p><p><code>event Signed(bytes32 PermissionHash)</code></p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/openlawteam/tribute-contracts/edit/docs/website/docs/contracts/extensions/ERC1271.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#extension-description-and-scope" class="table-of-contents__link">Extension description and scope</a></li><li><a href="#extension-workflow" class="table-of-contents__link">Extension workflow</a></li><li><a href="#extension-state" class="table-of-contents__link">Extension state</a><ul><li><a href="#daoregistry-public-dao" class="table-of-contents__link">DaoRegistry public dao;</a></li><li><a href="#bool-public-initialized--false" class="table-of-contents__link">bool public initialized = false;</a></li><li><a href="#daosignature-struct" class="table-of-contents__link">DAOSignature struct</a></li></ul></li><li><a href="#dependencies-and-interactions-internal--external" class="table-of-contents__link">Dependencies and interactions (internal / external)</a></li><li><a href="#functions-description-and-assumptions--checks" class="table-of-contents__link">Functions description and assumptions / checks</a><ul><li><a href="#function-initialize" class="table-of-contents__link">function initialize</a></li><li><a href="#function-sign" class="table-of-contents__link">function sign</a></li><li><a href="#function-isvalidsignature" class="table-of-contents__link">function isValidSignature</a></li></ul></li><li><a href="#events" class="table-of-contents__link">Events</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright"><p>&copy; TributeDAO Framework.</p></div></div></div></footer></div>
<script src="/assets/js/runtime~main.dff14f16.js"></script>
<script src="/assets/js/main.bf7fe461.js"></script>
</body>
</html>