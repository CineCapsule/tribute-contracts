(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[589],{3905:function(e,n,t){"use strict";t.d(n,{Zo:function(){return u},kt:function(){return m}});var a=t(7294);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,a,i=function(e,n){if(null==e)return{};var t,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var l=a.createContext({}),c=function(e){var n=a.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},u=function(e){var n=c(e.components);return a.createElement(l.Provider,{value:n},e.children)},d={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},p=a.forwardRef((function(e,n){var t=e.components,i=e.mdxType,r=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),p=c(t),m=i,f=p["".concat(l,".").concat(m)]||p[m]||d[m]||r;return t?a.createElement(f,o(o({ref:n},u),{},{components:t})):a.createElement(f,o({ref:n},u))}));function m(e,n){var t=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var r=t.length,o=new Array(r);o[0]=p;var s={};for(var l in n)hasOwnProperty.call(n,l)&&(s[l]=n[l]);s.originalType=e,s.mdxType="string"==typeof e?e:i,o[1]=s;for(var c=2;c<r;c++)o[c]=t[c];return a.createElement.apply(null,o)}return a.createElement.apply(null,t)}p.displayName="MDXCreateElement"},3758:function(e,n,t){"use strict";t.r(n),t.d(n,{frontMatter:function(){return s},metadata:function(){return l},toc:function(){return c},default:function(){return d}});var a=t(2122),i=t(9756),r=(t(7294),t(3905)),o=["components"],s={id:"erc20-extension",title:"ERC20"},l={unversionedId:"extensions/erc20-extension",id:"extensions/erc20-extension",isDocsHomePage:!1,title:"ERC20",description:"Extension description and scope",source:"@site/docs/extensions/ERC20.md",sourceDirName:"extensions",slug:"/extensions/erc20-extension",permalink:"/tribute-contracts/docs/extensions/erc20-extension",editUrl:"https://github.com/openlawteam/tribute-contracts/edit/docs/website/docs/extensions/ERC20.md",version:"current",frontMatter:{id:"erc20-extension",title:"ERC20"}},c=[{value:"Extension description and scope",id:"extension-description-and-scope",children:[]},{value:"Extension state",id:"extension-state",children:[{value:"DaoRegistry public dao;",id:"daoregistry-public-dao",children:[]},{value:"bytes32 public constant ERC20_EXT_TRANSFER_TYPE = keccak256(&quot;erc20ExtTransferType&quot;);",id:"bytes32-public-constant-erc20_ext_transfer_type--keccak256erc20exttransfertype",children:[]},{value:"bool public initialized = false;",id:"bool-public-initialized--false",children:[]},{value:"address public tokenAddress;",id:"address-public-tokenaddress",children:[]},{value:"string public tokenName;",id:"string-public-tokenname",children:[]},{value:"string public tokenSymbol;",id:"string-public-tokensymbol",children:[]},{value:"uint8 public tokenDecimals;",id:"uint8-public-tokendecimals",children:[]},{value:"mapping(address =&gt; mapping(address =&gt; uint256)) private _allowances;",id:"mappingaddress--mappingaddress--uint256-private-_allowances",children:[]}]},{value:"Extension functions",id:"extension-functions",children:[{value:"function initialize",id:"function-initialize",children:[]},{value:"function token",id:"function-token",children:[]},{value:"function setToken",id:"function-settoken",children:[]},{value:"function name",id:"function-name",children:[]},{value:"function setName",id:"function-setname",children:[]},{value:"function symbol",id:"function-symbol",children:[]},{value:"function setSymbol",id:"function-setsymbol",children:[]},{value:"function decimals",id:"function-decimals",children:[]},{value:"function setDecimals",id:"function-setdecimals",children:[]},{value:"function totalSupply",id:"function-totalsupply",children:[]},{value:"function balanceOf",id:"function-balanceof",children:[]},{value:"function allowance",id:"function-allowance",children:[]},{value:"function approve",id:"function-approve",children:[]},{value:"function transfer",id:"function-transfer",children:[]},{value:"function transferFrom",id:"function-transferfrom",children:[]}]},{value:"Events",id:"events",children:[]}],u={toc:c};function d(e){var n=e.components,t=(0,i.Z)(e,o);return(0,r.kt)("wrapper",(0,a.Z)({},u,t,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"extension-description-and-scope"},"Extension description and scope"),(0,r.kt)("p",null,"An ",(0,r.kt)("a",{parentName:"p",href:"https://docs.openzeppelin.com/contracts/3.x/api/token/erc20"},"ERC20")," contract safely manages the transfers of tokens that represent the voting power of each member of the DAO."),(0,r.kt)("p",null,"The extension adds to the DAO the capability of managing the voting power of members and external individuals in the DAO. It does that by tracking the token transfers between DAO members, or even, transfer from members to external accounts. That enhances the DAO features by allowing individuals that are not part of the DAO receive voting rights."),(0,r.kt)("h2",{id:"extension-state"},"Extension state"),(0,r.kt)("h3",{id:"daoregistry-public-dao"},"DaoRegistry public dao;"),(0,r.kt)("p",null,"The DAO address that this extension belongs to"),(0,r.kt)("h3",{id:"bytes32-public-constant-erc20_ext_transfer_type--keccak256erc20exttransfertype"},'bytes32 public constant ERC20_EXT_TRANSFER_TYPE = keccak256("erc20ExtTransferType");'),(0,r.kt)("p",null,"The custom configuration to set the transfer type, e.g:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"0: transfers are enabled only between dao members"),(0,r.kt)("li",{parentName:"ul"},"1: transfers are enabled between dao members and external accounts"),(0,r.kt)("li",{parentName:"ul"},"2: all transfers are paused")),(0,r.kt)("p",null,"It needs to be set via a ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/openlawteam/tribute-contracts/blob/master/docs/adapters/Configuration.md"},"Configuration proposal"),", if the proposal pass, the new configuration gets stored in the DAO. By default, only transfers between members are allowed."),(0,r.kt)("h3",{id:"bool-public-initialized--false"},"bool public initialized = false;"),(0,r.kt)("p",null,"Internally tracks deployment under eip-1167 proxy pattern"),(0,r.kt)("h3",{id:"address-public-tokenaddress"},"address public tokenAddress;"),(0,r.kt)("p",null,"The token address managed by the DAO that tracks the internal transfers"),(0,r.kt)("h3",{id:"string-public-tokenname"},"string public tokenName;"),(0,r.kt)("p",null,"The name of the token managed by the DAO"),(0,r.kt)("h3",{id:"string-public-tokensymbol"},"string public tokenSymbol;"),(0,r.kt)("p",null,"The symbol of the token managed by the DAO"),(0,r.kt)("h3",{id:"uint8-public-tokendecimals"},"uint8 public tokenDecimals;"),(0,r.kt)("p",null,"The number of decimals of the token managed by the DAO. The default number of decimals is 0 in ",(0,r.kt)("inlineCode",{parentName:"p"},"utils/DeploymentUtils.js."),' It is set to 0, because then the number of Units issued by the Bank Extension is tracked on a 1:1 basis with the number of tokens. For example, in the DAO issues 1 Unit to a member, then the display in a wallet such as MetaMask will be equal "1" Token. Otherwise, if the default was to the standard 18 decimals, then it would display in MetaMask as "0.000000000000000001" Token.'),(0,r.kt)("h3",{id:"mappingaddress--mappingaddress--uint256-private-_allowances"},"mapping(address => mapping(address => uint256)) private ","_","allowances;"),(0,r.kt)("p",null,"Tracks all the token allowances: owner => spender => amount"),(0,r.kt)("h4",{id:"access-flags"},"Access Flags"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/openlawteam/tribute-contracts/blob/master/docs/extensions/Bank.md"},"Bank"),":",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"INTERNAL_TRANSFER: true"),":"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/openlawteam/tribute-contracts/blob/master/docs/core/DaoRegistry.md"},"DAO"),":",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"NEW_MEMBER: true"))))),(0,r.kt)("p",null,"Access Control Layer Flags - explicitly grant the extension permissions to change the bank and dao states."),(0,r.kt)("h2",{id:"extension-functions"},"Extension functions"),(0,r.kt)("h3",{id:"function-initialize"},"function initialize"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-solidity"},"/**\n  * @notice Initializes the extension with the DAO that it belongs to,\n  * and checks if the parameters were set.\n  * @param _dao The address of the DAO that owns the extension.\n  * @param creator The owner of the DAO and Extension that is also a member of the DAO.\n  */\nfunction initialize(DaoRegistry _dao, address creator) external override\n")),(0,r.kt)("h3",{id:"function-token"},"function token"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-solidity"},"/**\n  * @dev Returns the token address managed by the DAO that tracks the\n  * internal transfers.\n  */\nfunction token() public view virtual returns (address)\n")),(0,r.kt)("h3",{id:"function-settoken"},"function setToken"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-solidity"},"/**\n  * @dev Sets the token address if the extension is not initialized,\n  * not reserved and not zero.\n  */\nfunction setToken(address _tokenAddress) external\n")),(0,r.kt)("h3",{id:"function-name"},"function name"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-solidity"},"/**\n  * @dev Returns the name of the token.\n  */\nfunction name() public view virtual returns (string memory)\n")),(0,r.kt)("h3",{id:"function-setname"},"function setName"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-solidity"},"/**\n  * @dev Sets the name of the token if the extension is not initialized.\n  */\nfunction setName(string memory _name) external\n")),(0,r.kt)("h3",{id:"function-symbol"},"function symbol"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-solidity"},"/**\n  * @dev Returns the symbol of the token, usually a shorter version of the\n  * name.\n  */\nfunction symbol() public view virtual returns (string memory)\n")),(0,r.kt)("h3",{id:"function-setsymbol"},"function setSymbol"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-solidity"},"/**\n  * @dev Sets the token symbol if the extension is not initialized.\n  */\nfunction setSymbol(string memory _symbol) external\n")),(0,r.kt)("h3",{id:"function-decimals"},"function decimals"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-solidity"},"/**\n  * @dev Returns the number of decimals used to get its user representation.\n  * For example, if `decimals` equals `2`, a balance of `505` tokens should\n  * be displayed to a user as `5,05` (`505 / 10 ** 2`).\n  */\nfunction decimals() public view virtual returns (uint8)\n")),(0,r.kt)("h3",{id:"function-setdecimals"},"function setDecimals"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-solidity"},"/**\n  * @dev Sets the token decimals if the extension is not initialized.\n  */\nfunction setDecimals(uint8 _decimals) external\n")),(0,r.kt)("h3",{id:"function-totalsupply"},"function totalSupply"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-solidity"},"/**\n  * @dev Returns the amount of tokens in existence.\n  */\nfunction totalSupply() public view override returns (uint256)\n")),(0,r.kt)("h3",{id:"function-balanceof"},"function balanceOf"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-solidity"},"/**\n  * @dev Returns the amount of tokens owned by `account`.\n  */\nfunction balanceOf(address account) public view override returns (uint256)\n")),(0,r.kt)("h3",{id:"function-allowance"},"function allowance"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-solidity"},"/**\n  * @dev Returns the remaining number of tokens that `spender` will be\n  * allowed to spend on behalf of `owner` through {transferFrom}. This is\n  * zero by default.\n  *\n  * This value changes when {approve} or {transferFrom} are called.\n  */\nfunction allowance(address owner, address spender)\n    public\n    view\n    override\n    returns (uint256)\n")),(0,r.kt)("h3",{id:"function-approve"},"function approve"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-solidity"},"/**\n  * @dev Sets `amount` as the allowance of `spender` over the caller's tokens.\n  * @param spender The address account that will have the units decremented.\n  * @param amount The amount to decrement from the spender account.\n  * @return a boolean value indicating whether the operation succeeded.\n  *\n  * Emits an {Approval} event.\n  */\nfunction approve(address spender, uint256 amount)\n    public\n    override\n    reentrancyGuard(dao)\n    returns (bool)\n")),(0,r.kt)("h3",{id:"function-transfer"},"function transfer"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-solidity"},"/**\n  * @dev Moves `amount` tokens from the caller's account to `recipient`.\n  * @dev The transfer operation follows the DAO configuration specified\n  * by the ERC20_EXT_TRANSFER_TYPE property.\n  * @param recipient The address account that will have the units incremented.\n  * @param amount The amount to increment in the recipient account.\n  * @return a boolean value indicating whether the operation succeeded.\n  *\n  * Emits a {Transfer} event.\n  */\nfunction transfer(address recipient, uint256 amount)\n    public\n    override\n    reentrancyGuard(dao)\n    returns (bool)\n")),(0,r.kt)("h3",{id:"function-transferfrom"},"function transferFrom"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-solidity"},"/**\n  * @dev Moves `amount` tokens from `sender` to `recipient` using the\n  * allowance mechanism. `amount` is then deducted from the caller's\n  * allowance.\n  * @dev The transfer operation follows the DAO configuration specified\n  * by the ERC20_EXT_TRANSFER_TYPE property.\n  * @param sender The address account that will have the units decremented.\n  * @param recipient The address account that will have the units incremented.\n  * @param amount The amount to decrement from the sender account.\n  * @return a boolean value indicating whether the operation succeeded.\n  *\n  * Emits a {Transfer} event.\n  */\nfunction transferFrom(\n    address sender,\n    address recipient,\n    uint256 amount\n) public override reentrancyGuard(dao) returns (bool)\n")),(0,r.kt)("h2",{id:"events"},"Events"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Approval"),": when the sender approves a spender to transfer a certain amount."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Transfer"),": when the transfer happens between DAO members and/or external accounts.")))}d.isMDXComponent=!0}}]);